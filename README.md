# Estimating the Value of CEOs in Privately Held Businesses

**Authors:** Miklós Koren, Krisztina Orbán, Bálint Szilágyi, Álmos Telegdy, András Vereckei

## Overview

This project analyzes the impact of CEOs on the performance of privately held businesses in Hungary from 1992 to 2022. The code in this replication package constructs the analysis files from two main proprietary data sources using Stata and Julia. The Makefile automates the entire process to generate the data for tables and figures in the paper. The replicator should expect the code to run for approximately 2-4 hours on a standard desktop machine.

## Data Availability and Provenance Statements

### Data Sources

Our analysis uses comprehensive administrative data on Hungarian firms during 1992-2022, created by merging balance sheet data with firm registry information. The balance sheet data come from the **Mérleg LTS dataset**, which contains financial information for essentially all Hungarian firms required to file annual reports. The firm registry data come from the **Cégjegyzék LTS dataset**, which includes information on firm registration, ownership structure, and executive appointments. Both datasets are distributed by HUN-REN KRTK and originally published by Opten Zrt.

### Why Data Cannot be Shared

The data are **proprietary and cannot be made public**. The datasets contain sensitive firm-level administrative information that is subject to strict confidentiality and redistribution restrictions under the original data use agreements with Opten Zrt and HUN-REN KRTK.

### How to Obtain Access

**For Commercial Use:**
Interested researchers should contact **opten.hu** to obtain a license. Annual license fees are in the order of **10,000 EUR** and you can expect contract negotiation and data access within **1-2 months**.

**For Academic/Replication Use:**
For replication purposes or academic research projects, researchers may contact **KRTK Adatbank** at: https://adatbank.krtk.mta.hu/

### Statement about Rights

- [x] I certify that the author(s) of the manuscript have legitimate access to and permission to use the data used in this manuscript.
- [ ] I certify that the author(s) of the manuscript have documented permission to redistribute/publish the data contained within this replication package.

### Summary of Availability

- [ ] All data **are** publicly available.
- [ ] Some data **cannot be made** publicly available.
- [x] **No data can be made** publicly available.

### Details on each Data Source

| Data Name | Data Files | Location | Provided | Citation |
|-----------|------------|----------|----------|----------|
| Hungarian Balance Sheet Data | balance_sheet_80_22.dta | input/merleg-LTS-2023/balance/ | No | HUN-REN KRTK (2024a) |
| Hungarian CEO Panel | ceo-panel.dta | input/ceo-panel/ | No | HUN-REN KRTK (2024b) |

#### Hungarian Balance Sheet Data (Mérleg LTS)

The balance sheet data include all firms required to file financial statements with Hungarian authorities, covering essentially the entire formal business sector except for the smallest individual entrepreneurs. The dataset contains detailed financial information including sales revenue, export revenue, employment, tangible and intangible assets, raw materials costs, wage bills, personnel expenses, and ownership indicators for state and foreign control. Data are in Stata format (.dta) with full variable and value labels.

#### Hungarian CEO Panel (Cégjegyzék LTS)

The firm registry data include information on firm registration, ownership structure, and executive appointments. The dataset contains information on CEO characteristics including gender, birth year, manager category, and ownership status. Data are in Stata format (.dta) with full variable and value labels.

## Dataset list

| Data file | Source | Notes | Provided |
|-----------|--------|-------|----------|
| `input/merleg-LTS-2023/balance/balance_sheet_80_22.dta` | Mérleg LTS | Balance sheet data 1980-2022 | No |
| `input/ceo-panel/ceo-panel.dta` | Cégjegyzék LTS | CEO panel data | No |
| `temp/balance.dta` | Derived | Processed balance sheet data | Generated by code |
| `temp/ceo-panel.dta` | Derived | Processed CEO panel data | Generated by code |
| `temp/analysis-sample.dta` | Derived | Final analytical dataset | Generated by code |
| `temp/edgelist.csv` | Derived | Firm-manager network edgelist | Generated by code |
| `temp/large_component_managers.csv` | Derived | Manager IDs in largest connected component | Generated by code |
| `temp/surplus.dta` | Derived | Dataset with estimated surplus and manager skills | Generated by code |

## Computational requirements

### Software Requirements

- Stata (code was last run with version 18.0)
  - Required packages: reghdfe (version 6.12.5 27Dec2023), estout (for table generation)
- Julia (code was last run with version 1.10.4)
  - Required packages: CSV, DataFrames, Graphs, SparseArrays (specified in Project.toml)
- LaTeX (for compiling `output/paper.tex`)
  - Standard LaTeX distribution with packages: booktabs, graphicx, natbib, hyperref
- Make (for running the Makefile)

**Important:** All scripts must be run from the project root directory to ensure correct relative file paths.

### Memory, Runtime, Storage Requirements

#### Summary

Approximate time needed to reproduce the analyses on a standard (2024) desktop machine:

- [x] 2-8 hours

Approximate storage space needed:

- [x] 2 GB - 25 GB (depending on input data size)

#### Details

The code was last run on a **MacOS machine with Stata 18.0 and Julia 1.10.4**. Processing involves substantial data manipulation of millions of firm-year observations and network analysis of 1.4 million firm-manager connections, requiring adequate RAM and processing power.

## Description of programs/code

### Makefile

The project includes a **Makefile** that automates the entire analysis pipeline. The Makefile specifies dependencies between scripts and ensures proper execution order:

- `temp/balance.dta` depends on `code/create/balance.do` and input balance sheet data
- `temp/ceo-panel.dta` depends on `code/create/ceo-panel.do` and input CEO panel data  
- `temp/analysis-sample.dta` depends on `code/create/analysis-sample.do`, balance data, CEO data, and utility scripts
- `temp/edgelist.csv` depends on `code/create/edgelist.do` and analysis sample data
- `temp/large_component_managers.csv` depends on `code/create/connected_component.jl` and edgelist data
- `temp/surplus.dta` depends on `code/estimate/surplus.do` and analysis sample data
- `output/table/manager_effects.tex` and `output/figure/*.pdf` depend on `code/estimate/manager_value.do` and surplus data
- `output/paper.pdf` depends on `output/paper.tex` and all tables and figures

**All commands must be run from the project root directory.**

### Code Structure

- `code/create/balance.do`: Processes raw balance sheet data, applies time restrictions (1992-2022), filters data quality issues, and creates standardized variables
- `code/create/ceo-panel.do`: Processes CEO registry data, constructs CEO panel with firm-person-year structure, and generates CEO count variables
- `code/create/analysis-sample.do`: Merges CEO and balance sheet data, applies industry classifications, creates analysis variables, and implements sample restrictions
- `code/create/edgelist.do`: Extracts firm-manager edgelist from analysis sample and exports to CSV format
- `code/create/connected_component.jl`: Julia script for network analysis that projects bipartite firm-manager graph and identifies largest connected component of managers
- `code/estimate/surplus.do`: Estimates revenue function and residualizes surplus for manager skill identification
- `code/estimate/manager_value.do`: Estimates manager skills using fixed effects, creates histograms and regression tables showing manager effects on firm outcomes
- `code/util/industry.do`: Creates industry sector classifications using TEAOR08 codes
- `code/util/variables.do`: Constructs derived variables including log transformations, CEO tenure, age variables, and firm characteristics
- `code/util/filter.do`: Applies final sample restrictions excluding firms with complex CEO structures or specific industries

## Instructions to Replicators

1. **Obtain the data**: Follow the instructions above to obtain access to the Mérleg LTS and Cégjegyzék LTS datasets from Opten Zrt or KRTK Adatbank.

2. **Place data files**: 
   - Place `balance_sheet_80_22.dta` in `input/merleg-LTS-2023/balance/`
   - Place `ceo-panel.dta` in `input/ceo-panel/`

3. **Run the analysis**: From the project root directory, execute:
   ```bash
   make all
   ```
   This will run all Stata scripts in the correct order and compile the LaTeX document.

4. **Alternative manual execution**: If Make is not available, run the following commands from the project root:
   ```bash
   # Process data with Stata
   stata -b do code/create/balance.do
   stata -b do code/create/ceo-panel.do
   stata -b do code/create/analysis-sample.do
   stata -b do code/create/edgelist.do
   
   # Run network analysis with Julia
   julia --project=. code/create/connected_component.jl
   
   # Generate econometric analysis
   stata -b do code/estimate/surplus.do
   stata -b do code/estimate/manager_value.do
   ```
   Then compile the LaTeX document:
   ```bash
   cd output && pdflatex paper.tex && bibtex paper && pdflatex paper.tex && pdflatex paper.tex
   ```

### Details

- The Stata scripts generate comprehensive log files documenting all data processing steps
- Intermediate datasets are saved in the `temp/` directory
- The final analytical sample contains 8,872,039 firm-year observations representing 960,464 unique firms
- Manager skill analysis identifies 180,421 managers in the largest connected component
- All file paths in the scripts are relative to the project root directory

## Main Results

Our analysis yields three key findings about CEO value in Hungarian private firms:

1. **Substantial CEO heterogeneity**: Within firms, replacing a CEO at the 25th percentile of the skill distribution with one at the 75th percentile increases firm productivity by 9.8% and surplus by 118%.

2. **Even larger variation across the managerial labor market**: In the connected component of managers who move between firms, the same percentile replacement increases productivity by 25.6% and surplus by 461%.

3. **Meaningful contribution to firm outcomes**: Manager skills exhibit significant correlations with revenue (coefficient: 0.086), EBITDA (0.055), and employment (0.090) in the connected component analysis.

These results demonstrate quantifiable CEO value in private firms using administrative data, with implications for entrepreneurship policy and economic development.

## List of tables and programs

The provided code reproduces:

- [x] All tables and figures in the paper

| Figure/Table # | Program | Output file | Note |
|----------------|---------|-------------|----- |
| Table 1 (Sample Distribution) | balance.do | Embedded in paper.tex | Temporal distribution by year |
| Table 2 (Industry Composition) | analysis-sample.do | Embedded in paper.tex | Industry sector breakdown |
| Table 3 (CEO Structure) | analysis-sample.do | Embedded in paper.tex | CEO turnover patterns |
| Figure 1 (Manager Skill Distributions) | manager_value.do | output/figure/manager_skill_within.pdf, output/figure/manager_skill_connected.pdf | Panel A: Within-firm variation, Panel B: Connected component |
| Table 4 (Manager Skill Effects) | manager_value.do | output/table/manager_effects.tex | Effects on revenue, EBITDA, employment |
| Table 5 (Revenue Function) | surplus.do | output/table/revenue_function.tex | Revenue function estimates |
| Table 6 (Revenue by Sector) | surplus.do | output/table/revenue_sectors.tex | Revenue function by industry |

# Sample

```stata
. tabulate year, missing

       Year |
  1980-2022 |      Freq.     Percent        Cum.
------------+-----------------------------------
       1992 |     98,780        0.97        0.97
       1993 |    122,677        1.20        2.17
       1994 |    153,639        1.50        3.67
       1995 |    171,759        1.68        5.35
       1996 |    198,558        1.94        7.30
       1997 |    219,751        2.15        9.45
       1998 |    246,660        2.41       11.86
       1999 |    256,992        2.52       14.38
       2000 |    280,386        2.75       17.13
       2001 |    302,894        2.97       20.09
       2002 |    301,278        2.95       23.04
       2003 |    305,947        3.00       26.04
       2004 |    319,750        3.13       29.17
       2005 |    326,905        3.20       32.37
       2006 |    334,498        3.27       35.64
       2007 |    345,134        3.38       39.02
       2008 |    362,920        3.55       42.57
       2009 |    370,788        3.63       46.20
       2010 |    384,570        3.77       49.97
       2011 |    402,636        3.94       53.91
       2012 |    397,131        3.89       57.80
       2013 |    437,692        4.29       62.08
       2014 |    427,494        4.19       66.27
       2015 |    433,371        4.24       70.51
       2016 |    431,041        4.22       74.73
       2017 |    424,184        4.15       78.89
       2018 |    425,601        4.17       83.05
       2019 |    419,883        4.11       87.16
       2020 |    424,501        4.16       91.32
       2021 |    432,594        4.24       95.55
       2022 |    454,106        4.45      100.00
------------+-----------------------------------
      Total | 10,214,120      100.00
```

# Acknowledgements
- Project no. 144193 has been implemented with the support provided by the Ministry of 
  Culture and Innovation of Hungary from the National Research, Development and 
  Innovation Fund, financed under the KKP_22 funding scheme.
- This project was funded by the European Research Council (ERC Advanced Grant 
  agreement number 101097789). The views expressed in this research are those of the authors and 
  do not necessary reflect the official view of the European Union or the European 
  Research Council.

# References
- HUN-REN KRTK (distributor). 2024. "Cégjegyzék LTS [data set]" Published by Opten 
  Zrt, Budapest. Contributions by CEU MicroData.
- HUN-REN KRTK (distributor). 2024. "Mérleg LTS [data set]" Published by Opten Zrt, 
  Budapest. Contributions by CEU MicroData.
